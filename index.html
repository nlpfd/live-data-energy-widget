<script>
    function fetchLiveData() {
        fetch('https://api.carbonintensity.org.uk/regional/regionid/13')
        .then(response => response.json())
        .then(data => {
            console.log('API Response:', data); // This logs the full response
            const region = data.data[0];
            if (!region || !region.generationmix) {
                console.error('Generation mix data not available');
                document.getElementById('live-percentage').textContent = 'Data unavailable';
                return;
            }
            const wind = region.generationmix.find(item => item.fuel === 'wind')?.perc || 0;
            const solar = region.generationmix.find(item => item.fuel === 'solar')?.perc || 0;
            const combinedRenewables = Math.round(wind + solar);
            document.getElementById('live-percentage').textContent = combinedRenewables + "%";
        })
        .catch(error => console.error('Error fetching data:', error));
    }
    window.onload = fetchLiveData;
</script>
